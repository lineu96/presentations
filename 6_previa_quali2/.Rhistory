peso <- read.csv2('peso.csv', sep = ',', dec = '.')
setwd("~/Área de Trabalho")
peso <- read.csv2('peso.csv', sep = ',', dec = '.')
peso$data <- as.Date(peso$data,
format = "%d/%m/%y")
nrow(peso)
summary(peso$peso)
sd(peso$peso)
library(ggplot2)
ggplot(data = peso[1:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
#geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
peso
peso[35:49,]
summary(peso[35:49,])
ggplot(data = peso[35:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
#geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
ggplot(data = peso[35:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
#35
ggplot(data = peso[1:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
peso <- read.csv2('peso.csv', sep = ',', dec = '.')
peso$data <- as.Date(peso$data,
format = "%d/%m/%y")
nrow(peso)
summary(peso$peso)
sd(peso$peso)
library(ggplot2)
#35
ggplot(data = peso[1:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
#35
ggplot(data = peso[35:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
peso <- read.csv2('peso.csv', sep = ',', dec = '.')
peso$data <- as.Date(peso$data,
format = "%d/%m/%y")
nrow(peso)
summary(peso$peso)
sd(peso$peso)
library(ggplot2)
#35
ggplot(data = peso[1:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
#35
ggplot(data = peso[35:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
peso <- read.csv2('peso.csv', sep = ',', dec = '.')
peso$data <- as.Date(peso$data,
format = "%d/%m/%y")
nrow(peso)
summary(peso$peso)
sd(peso$peso)
library(ggplot2)
#35
ggplot(data = peso[35:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
#35
c(35:39,41:nrow(peso))
ggplot(data = peso[c(35:39,41:nrow(peso)),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
ggplot(data = peso[1:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
peso <- read.csv2('peso.csv', sep = ',', dec = '.')
peso$data <- as.Date(peso$data,
format = "%d/%m/%y")
nrow(peso)
summary(peso$peso)
sd(peso$peso)
library(ggplot2)
ggplot(data = peso[1:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
peso <- read.csv2('peso.csv', sep = ',', dec = '.')
peso$data <- as.Date(peso$data,
format = "%d/%m/%y")
nrow(peso)
summary(peso$peso)
sd(peso$peso)
library(ggplot2)
ggplot(data = peso[1:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
ggplot(data = peso[35:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
peso[35:nrow(peso),]
peso <- read.csv2('peso.csv', sep = ',', dec = '.')
peso$data <- as.Date(peso$data,
format = "%d/%m/%y")
nrow(peso)
summary(peso$peso)
sd(peso$peso)
library(ggplot2)
ggplot(data = peso[35:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
ggplot(data = peso[1:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
peso <- read.csv2('peso.csv', sep = ',', dec = '.')
peso$data <- as.Date(peso$data,
format = "%d/%m/%y")
nrow(peso)
summary(peso$peso)
sd(peso$peso)
library(ggplot2)
ggplot(data = peso[1:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
#35
x11()
ggplot(data = peso[1:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
ggplot(data = peso[35:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
summary(peso$peso)
peso[1:nrow(peso),]$peso
mean(peso[1:nrow(peso),]$peso)
mean(peso[35:nrow(peso),]$peso)
peso <- read.csv2('peso.csv', sep = ',', dec = '.')
peso$data <- as.Date(peso$data,
format = "%d/%m/%y")
nrow(peso)
summary(peso$peso)
sd(peso$peso)
mean(peso[35:nrow(peso),]$peso)
library(ggplot2)
x11()
ggplot(data = peso[1:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
ggplot(data = peso[35:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
peso <- read.csv2('peso.csv', sep = ',', dec = '.')
peso$data <- as.Date(peso$data,
format = "%d/%m/%y")
nrow(peso)
summary(peso$peso)
sd(peso$peso)
mean(peso[35:nrow(peso),]$peso)
library(ggplot2)
x11()
ggplot(data = peso[1:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
peso <- read.csv2('peso.csv', sep = ',', dec = '.')
peso$data <- as.Date(peso$data,
format = "%d/%m/%y")
nrow(peso)
summary(peso$peso)
sd(peso$peso)
mean(peso[35:nrow(peso),]$peso)
library(ggplot2)
#35
x11()
ggplot(data = peso[1:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
ggplot(data = peso[35:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
peso <- read.csv2('peso.csv', sep = ',', dec = '.')
peso$data <- as.Date(peso$data,
format = "%d/%m/%y")
nrow(peso)
summary(peso$peso)
sd(peso$peso)
mean(peso[35:nrow(peso),]$peso)
library(ggplot2)
#35
x11()
a <- ggplot(data = peso[1:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
b <- ggplot(data = peso[35:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
ggpubr::ggarrange(a,b,ncol=2)
peso <- read.csv2('peso.csv', sep = ',', dec = '.')
peso$data <- as.Date(peso$data,
format = "%d/%m/%y")
nrow(peso)
summary(peso$peso)
sd(peso$peso)
mean(peso[35:nrow(peso),]$peso)
library(ggplot2)
#35
x11()
a <- ggplot(data = peso[1:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
b <- ggplot(data = peso[35:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
ggpubr::ggarrange(a,b,ncol=2)
b <- ggplot(data = peso[55:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
b
b <- ggplot(data = peso[45:nrow(peso),], aes(x = data, y = peso)) +
geom_point(size = 3) + geom_line() +
geom_smooth(se = F, method = 'lm')+
geom_smooth(se = F, method = 'loess', col = 2)+
labs(x = "Data",
y = "Peso (kg)",
title = "Série de peso",
subtitle = "Lineu Alberto") + theme_linedraw()
b
setwd("~/Área de Trabalho/pet_convida")
library(mcglm)
library(car)
source('~/msc/3_th_mcglm/0_funcoes/functions.R')
# Dados
?labestData::PaulaEg1.12.5
dados <- labestData::PaulaEg1.12.5[ , -1]
# MODELO SEM INTERAÇÕES
form  <- cons ~ (taxa + licen + renda + estr)
m1 <- glm(formula = form, data = dados)
# McGLM
Z0 <- mc_id(dados) # Identidade
m2 <- mcglm(linear_pred = c(form),
matrix_pred = list(c(Z0)),
data = dados)
# Estimativas
data.frame(glm = round(m1$coefficients, 2),
mcglm = round(m2$Regression, 2))
## Tipo II
Anova(m1, type = 'II', test.statistic = 'Wald')
mc_anova_II(m2)[[1]]
mc_manova_II(m2)
## Tipo III
Anova(m1, type = 'III', test.statistic = 'Wald')
mc_anova_III(m2)[[1]]
mc_manova_III(m2)
## Testando se todos os parametros sao 0
linearHypothesis(m1, c("(Intercept) = 0",
"taxa = 0",
"licen = 0",
"renda = 0",
"estr = 0"))
parametros <- coef(m2, type = 'beta')
parametros$beta_names <- Reduce(c,m2$beta_names)
parametros
## Testando se todos os parametros sao 0
linearHypothesis(m1, c("(Intercept) = 0",
"taxa = 0",
"licen = 0",
"renda = 0",
"estr = 0"))
mc_linear_hypothesis(object =  m2,
hypothesis =  c('beta10 = 0',
'beta11 = 0',
'beta12 = 0',
'beta13 = 0',
'beta14 = 0'))
## Testando se o intercepto é igual a 380
linearHypothesis(m1, c("(Intercept) = 380"))
mc_linear_hypothesis(object =  m2,
hypothesis =  c('beta10 = 380'))
## Testando se beta taxa = beta licen
linearHypothesis(m1, c("taxa = licen"))
mc_linear_hypothesis(object =  m2,
hypothesis =  c('beta11 = beta12'))
# MODELO COM INTERAÇÕES
form2  <- cons ~ (taxa + licen + renda + estr)^2
# GLM
m1 <- glm(formula = form2, data = dados)
# McGLM
Z0 <- mc_id(dados) # Identidade
m2 <- mcglm(linear_pred = c(form2),
matrix_pred = list(c(Z0)),
data = dados)
# Estimativas
data.frame(glm = round(m1$coefficients, 2),
mcglm = round(m2$Regression, 2))
## Tipo III
Anova(m1, type = 'III', test.statistic = 'Wald')
mc_anova_III(m2)[[1]]
Anova(m1, type = 'II', test.statistic = 'Wald')
mc_anova_II(m2)[[1]]
linearHypothesis(m1, c("taxa = 0",
"taxa:licen = 0",
"taxa:renda = 0",
"taxa:estr = 0"))
1.7
1.7+650+650
1700+650+650
2000/35
54*35
20+20+10+8+10+8+10+5+16+16
